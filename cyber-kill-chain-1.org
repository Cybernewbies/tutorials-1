#+TITLE: Cyber Kill Chain
#+DATE: Part 1: Reconnaissance
#+AUTHOR: Zach Roof
#+OPTIONS: num:nil toc:3
#+OPTIONS: reveal_center:nil reveal_control:t width:100% height:100%
#+OPTIONS: reveal_history:nil reveal_keyboard:t reveal_overview:t
#+OPTIONS: reveal_slide_number:"c"
#+OPTIONS: reveal_title_slide:"<h2>%t</h2><h5>%d<h5>"
#+OPTIONS: reveal_progress:t reveal_rolling_links:nil reveal_single_file:nil
#+REVEAL_HLEVEL: 1
#+REVEAL_MARGIN: 0
#+REVEAL_MIN_SCALE: 1
#+REVEAL_MAX_SCALE: 1
#+REVEAL_ROOT: file:///Users/zachroof/repos/reveal.js
#+REVEAL_TRANS: default
#+REVEAL_SPEED: default
#+REVEAL_THEME: moon
#+REVEAL_EXTRA_CSS: file:///Users/zachroof/repos/weekly-sts-in-prog/local.css
#+REVEAL_PLUGINS: notes
# YOUTUBE_EXPORT_TAGS:INFOSec,TLS,SSL,Cryptography,Alice,Bob,Trent,Mallory,Active Attacks,Passive Attacks
# YOUTUBE_EXPORT_DESC: 'Start our learning journey into TLS/Cryptography by understanding the "Crypto-Chacters" and the common attacks that they represent.'
# TODO FT:Security-Controls, nmap
* Cyber Kill Chain
#+ATTR_REVEAL: :frag (appear)
+ Level: Beginner
+ Kill Chain
  + Military process for attacking an opponent
  + Lockheed Martin adapted concept for cyberattacks
+ Cyber Kill Chain
  + "Typical" stages of a cyberattack
    + Each stage can be mitigated by a set of controls
      + Controls are countermeasures

** Ex: PDF Attack
- Review last week's [[https://github.com/zachroof/sts-tutorials/blob/master/attack-vocab-1.org][vocabulary]] within Cyber Kill Chain context
- Ex: PDF Attack
  - Pretending to be the owner of VictCo Travel Agency, the attacker sent a malicious pdf to
    one of the 25 employees via a spoofed email. Through a Adobe Reader
    vulnerability, the attacker established a reverse shell and gained full
    control of the victim's computer

** Cyber Kill Chain Steps
*** 1. Reconnaissance
- Attacker sets goal and researches target
  #+ATTR_REVEAL: :frag (appear)
  - Goals are heavily related to motivations and skill level
    #+ATTR_REVEAL: :frag (appear)
    - Understanding how these areas relate to each other helps...
      #+ATTR_REVEAL: :frag (appear)
      1. Prevent research in the Reconnaissance Stage
         - If you know where an attacker might look, you have a significant advantage
         - Stop the attack at the source
      2. Mitigate active attacks
         - "X has attacked the network and gotten Y. Do they want anything else?"
#+REVEAL: split
- Common attack goals within the Reconnaissance Stage
  #+ATTR_REVEAL: :frag (appear)
  - Data exfiltration
    - Ex: Credit card numbers, intellectual property
  - Defacement
    - Ex: Denial Of Service (DoS), taunting
  - Extortion
    - Ex: Ransomware, leak of sensitive information
#+REVEAL: split
#+ATTR_REVEAL: :frag (appear)
- Motives are the foundation of goals
- Attack motives
  #+ATTR_REVEAL: :frag (appear)
  - Ideological
    - Ex: Political, humanitarian
  - Financial
  - Personal
    - Ego, curiosity
- Certain motives attract different skill sets
#+REVEAL: split
#+ATTR_REVEAL: :frag (appear)
- Skill Sets
  #+ATTR_REVEAL: :frag (appear)
  1. Expert Hackers
    #+ATTR_REVEAL: :frag (appear)
     - Often have financial resources for training, technology, etc.
     - Due to skills, are usually interested in "high reward" targets
     - Usually comprised within groups that are created by:
       #+ATTR_REVEAL: :frag (appear)
       - Nation States
         - Common attack motive: Ideological
       - Terrorists
         - Common attack motive: Ideological
       - Misc. Personal Relationships
         - Common attack motives: Ideological, Economic
         - [[https://en.wikipedia.org/wiki/List_of_hacker_groups][Hacker Groups]]
#+REVEAL: split
#+ATTR_REVEAL: :frag (appear)
  2. [@2] "Average" Hacker
     - Usually acting alone
     - "Benign" explorers, malicious intruders
     - Common attack motive: Economic
  3. Amateur
     - "Script Kiddie"
     - Lack finances/talent
       - Inflicts damage by common exploits
     - Common attack motive: Personal

#+REVEAL: split
**** Questions
#+ATTR_REVEAL: :frag (appear)
- Ex: PDF Attack
  - Pretending to be the owner of VictCo Travel Agency, the attacker sent a malicious pdf to
    one of the 25 employees via a spoofed email. Through a Adobe Reader
    vulnerability, the attacker established a reverse shell and gained full
    control of the victim's computer

- Q: What is the probable skill level behind this attack?
  #+ATTR_REVEAL: :frag (appear)
  - Essential Cybersecurity skill is working backwards
#+REVEAL: split
  - A: Average
    - Rationale
      - Expert Hackers?
        - 25 employee organization too small
      - Amateur?
        - Script Kiddie probably doesn't understand reverse shells

#+REVEAL: split
- Ex: PDF Attack
  - Pretending to be the owner of VictCo Travel Agency, the attacker sent a malicious pdf to
    one of the 25 employees via a spoofed email. Through a Adobe Reader
    vulnerability, the attacker established a reverse shell and gained full
    control of the victim's computer

- Q: What is the probable motive of this attack?
  #+ATTR_REVEAL: :frag (appear)
  - A: Financial
    - Rationale
      - Ideological?
        - No, VictCo is a travel agency
      - Personal?
        - No, low visibility attack

#+REVEAL: split
- Ex: PDF Attack
  - Pretending to be the owner of VictCo Travel Agency, the attacker sent a malicious pdf to
    one of the 25 employees via a spoofed email. Through a Adobe Reader
    vulnerability, the attacker established a reverse shell and gained full
    control of the victim's computer

- Q: Given the attacker's skill level, what recon was needed?
#+REVEAL: split
#+ATTR_REVEAL: :frag (appear)
- A: The attacker needed to find:
  #+ATTR_REVEAL: :frag (appear)
  - A vulnerable email server
  - Network connectivity for SSH access
    - Q: Where could this be blocked/filtered?
      #+ATTR_REVEAL: :frag (appear)
      - A: Host and Network Levels
      - A: Ingress/Egress Ports
  - A vulnerable version of Adobe Reader
  - Employee Information
    - LinkedIn, Facebook, etc.

- Q: What is the technical term for these findings?
  #+ATTR_REVEAL: :frag (appear)
  - A: Attack Surface

#+REVEAL: split
- Ex: PDF Attack
  - Pretending to be the owner of VictCo Travel Agency, the attacker sent a malicious pdf to
    one of the 25 employees via a spoofed email. Through a Adobe Reader
    vulnerability, the attacker established a reverse shell and gained full
    control of the victim's computer

- Q: Given the attacker's financial motivation, what recon might of occurred
  that we don't know about?
#+REVEAL: split
#+ATTR_REVEAL: :frag (appear)
- A: Looking for signs of what type of AntiVirus (AV) is enabled for payload
  evasion
  #+ATTR_REVEAL: :frag (appear)
  - Potential Payloads
    - Keylogger, Ransomware
  - AV Recon
    - Monitoring network traffic for AV updates
    - Public on-boarding documents for new employees
    - Going to various AV vendor websites and trying password resets with
      employee email addresses
      - If it displays, "Check your email" you know the employee registered
*** 2. Weaponization
#+ATTR_REVEAL: :frag (appear)
- Attacker creates/finds exploit based on reconnaissance
- Q: What is inside the exploit?
  #+ATTR_REVEAL: :frag (appear)
  - A: Payload
#+REVEAL: split
#+ATTR_REVEAL: :frag (appear)
- Ex: PDF Attack
  - Pretending to be the CEO of VictCo Travel Agency, the attacker sent a malicious pdf to a new
    employee via a spoofed email. Through a Adobe Reader vulnerability, the
    attacker established a reverse shell and gained full control of the victim's computer
- Q: What is the Payload?
  #+ATTR_REVEAL: :frag (appear)
  - A: The code that established the reverse shell
*** 3. Delivery
#+ATTR_REVEAL: :frag (appear)
- Attacker transmits the exploit to the target
- Q: This is achieved through a ____?
  #+ATTR_REVEAL: :frag (appear)
  - A: Attack Vector/s
- Q: What is the primary attack vector?
  #+ATTR_REVEAL: :frag (appear)
  - A: E-mail attachment

*** 4. Exploitation
#+ATTR_REVEAL: :frag (appear)
- Exploit is executed, which takes advantage of the vulnerability
- Q: What does the exploit do?
  #+ATTR_REVEAL: :frag (appear)
  - Prepping the environment for payload execution

*** 5. Installation
#+ATTR_REVEAL: :frag (appear)
- Exploit installs payload
- Ex: PDF Attack
  - Pretending to be the CEO of VictCo Travel Agency, the attacker sent a malicious pdf to a new
    employee via a spoofed email. Through a Adobe Reader vulnerability, the
    attacker established a reverse shell and gained full control of the victim's computer
- Q: What type of vulnerability exists within Adobe Reader?
  #+ATTR_REVEAL: :frag (appear)
  - Hint: What must be true for the reverse shell to occur?
  - A: Remote Code Execution (RCE) Vulnerability

*** 6. Command and Control (C&C)
#+ATTR_REVEAL: :frag (appear)
- Payload executes which enables the attacker to have persistent access to the victim
- Once foothold as been established, the process can easily repeat/morph
  - Ex: Pivoting to other systems on the network

*** 7. Actions on Objective
- Attacker takes action to achieve goals

** Cyber Kill Chain Applicability
#+ATTR_REVEAL: :frag (appear)
+ Obviously, this doesn't apply to every attack
+ Ex: Defacement via DoS
  + No C&C aspect, etc.
+ This is a general starting point for understanding cyberattacks
